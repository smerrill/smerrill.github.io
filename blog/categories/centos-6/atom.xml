<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: centos 6 | Grenade Sandwich]]></title>
  <link href="http://smerrill.github.io/blog/categories/centos-6/atom.xml" rel="self"/>
  <link href="http://smerrill.github.io/"/>
  <updated>2014-05-27T09:21:44-04:00</updated>
  <id>http://smerrill.github.io/</id>
  <author>
    <name><![CDATA[Steven W. Merrill]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[CentOS 6 and VirtualBox (VBoxHeadless CPU Usage Fix)]]></title>
    <link href="http://smerrill.github.io/blog/2011/08/29/centos-6-and-virtualbox/"/>
    <updated>2011-08-29T00:00:00-04:00</updated>
    <id>http://smerrill.github.io/blog/2011/08/29/centos-6-and-virtualbox</id>
    <content type="html"><![CDATA[<p><strong>TL;DR:</strong> Add &ldquo;noapic&rdquo; to your kernel line if your VBoxHeadless process uses far too much CPU.</p>

<p>I&rsquo;ve been working on making <a href="https://github.com/smerrill/veewee-fun/">space-efficient CentOS 5.6 and 6 images</a> for <a href="http://www.virtualbox.org">VirtualBox</a> recently. I&rsquo;m building the images as part of a pilot program to start using <a href="http://vagrantup.com">the Vagrant gem</a> to allow our developers to test the Drupal code they write on the real production OS before pushing it to the dev server. (I&rsquo;m also learning Puppet, both for this project and as a way to more easily re-use tested configurations as we launch new sites.)</p>

<p>The CentOS 5.6 images I made worked like a charm, but ran into a problem wherein the <em>VBoxHeadless</em> process that hosted my CentOS 6 image would always use 25% CPU on my MacBook Air (one full core) despite the guest OS showing between 98% and 100% idle.</p>

<!--more-->


<p>I read through a number of suggestions that applied to CentOS 5.6, which involved <a href="http://tiebing.blogspot.com/2011/08/virtualbox-vboxheadless-high-cpu-usage.html">setting <code>divider="10"</code></a> in the kernel parameters, but these have no effect under CentOS 6, which uses a tickless kernel.</p>

<p>In reading further on the subject, I found that some other forums advocated looking at the <a href="http://www.wlug.org.nz/APIC">APIC</a> settings. Sure enough, as soon as I added the text <code>noapic</code> to the end of my <strong>kernel</strong> line in <code>/boot/grub/grub.conf</code> and restarted, the issue went away.</p>
]]></content>
  </entry>
  
</feed>
