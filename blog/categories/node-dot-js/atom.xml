<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: node.js | Grenade Sandwich]]></title>
  <link href="http://smerrill.github.io/blog/categories/node-dot-js/atom.xml" rel="self"/>
  <link href="http://smerrill.github.io/"/>
  <updated>2014-05-27T09:28:12-04:00</updated>
  <id>http://smerrill.github.io/</id>
  <author>
    <name><![CDATA[Steven W. Merrill]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Dude, Where's My Bot?]]></title>
    <link href="http://smerrill.github.io/blog/2011/10/05/dude-wheres-my-bot/"/>
    <updated>2011-10-05T00:00:00-04:00</updated>
    <id>http://smerrill.github.io/blog/2011/10/05/dude-wheres-my-bot</id>
    <content type="html"><![CDATA[<p>Say what you will about node.js, but it is certainly an easy way to build IRC bots with the <a href="https://github.com/gf3/Jerk">Jerk library</a>.</p>

<p>The PHP-based bot that runs in the <a href="http://www.treehouseagency.com">Treehouse Agency</a> IRC channels knows to respond to &ldquo;Sweet!&rdquo; with &ldquo;Dude!&rdquo; and vice versa. <a href="http://www.brianmcmurray.com">Brian McMurray</a> said that he&rsquo;d like to someday write a quick-and-dirty bot that would put our other bot into an infinite loop.</p>

<p>I accepted that challenge, and 10 minutes later, the bot was done.</p>

<p>The code is an example of how to build a bot that accepts environmental variables for configuration and otherwise does a pretty silly task.</p>

<!--more-->


<p>All in all, node makes this <em>really</em> simple.</p>

<p><div class="highlight"><pre><code class="javascript"><span class="kd">var</span> <span class="nx">jerk</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">jerk</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;),</span><span class="o">&lt;</span><span class="err">/p&gt;</span>

<span class="o">&lt;</span><span class="nx">pre</span><span class="o">&gt;&lt;</span><span class="nx">code</span><span class="o">&gt;</span><span class="nx">channel</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;SWEETDUDEBOT_CHANNEL&#39;</span> <span class="k">in</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">)</span><span class="o">?</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">SWEETDUDEBOT_CHANNEL</span> <span class="o">:</span> <span class="s1">&#39;#yourchannel&#39;</span><span class="p">,</span>
<span class="nx">options</span> <span class="o">=</span> <span class="p">{</span>
  <span class="nx">server</span><span class="o">:</span> <span class="p">(</span><span class="s1">&#39;SWEETDUDEBOT_SERVER&#39;</span> <span class="k">in</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">)</span><span class="o">?</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">SWEETDUDEBOT_SERVER</span> <span class="o">:</span> <span class="s1">&#39;chat.freenode.net&#39;</span><span class="p">,</span>
  <span class="nx">nick</span><span class="o">:</span> <span class="p">(</span><span class="s1">&#39;SWEETDUDEBOT_NICK&#39;</span> <span class="k">in</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">)</span><span class="o">?</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">SWEETDUDEBOT_NICK</span> <span class="o">:</span> <span class="s1">&#39;sweetdudebot&#39;</span><span class="p">,</span>
  <span class="nx">port</span><span class="o">:</span> <span class="p">(</span><span class="s1">&#39;SWEETDUDEBOT_PORT&#39;</span> <span class="k">in</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">)</span><span class="o">?</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">SWEETDUDEBOT_PORT</span> <span class="o">:</span> <span class="s1">&#39;6667&#39;</span><span class="p">,</span>
  <span class="nx">flood_protection</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
  <span class="nx">channels</span><span class="o">:</span> <span class="p">[</span><span class="nx">channel</span><span class="p">]</span>
<span class="p">};</span>
<span class="o">&lt;</span><span class="err">/code&gt;&lt;/pre&gt;</span>

<span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="kd">var</span> <span class="nx">sweet_dude_bot</span> <span class="o">=</span> <span class="nx">jerk</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">j</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">j</span><span class="p">.</span><span class="nx">watch_for</span><span class="p">(</span> <span class="sr">/^(Sweet|Dude)!$/</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">message</span><span class="p">)</span> <span class="p">{</span><span class="o">&lt;</span><span class="err">/p&gt;</span>

<span class="o">&lt;</span><span class="nx">pre</span><span class="o">&gt;&lt;</span><span class="nx">code</span><span class="o">&gt;</span><span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">message</span><span class="p">.</span><span class="nx">match_data</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">result</span><span class="p">)</span>
  <span class="k">return</span><span class="p">;</span>

<span class="k">switch</span> <span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">case</span> <span class="s2">&quot;Sweet&quot;</span><span class="o">:</span>
    <span class="nx">message</span><span class="p">.</span><span class="nx">say</span><span class="p">(</span><span class="s2">&quot;Dude!&quot;</span><span class="p">);</span>
    <span class="k">break</span><span class="p">;</span>
  <span class="k">case</span> <span class="s2">&quot;Dude&quot;</span><span class="o">:</span>
    <span class="nx">message</span><span class="p">.</span><span class="nx">say</span><span class="p">(</span><span class="s2">&quot;Sweet!&quot;</span><span class="p">);</span>
    <span class="k">break</span><span class="p">;</span>
<span class="p">}</span>
<span class="o">&lt;</span><span class="err">/code&gt;&lt;/pre&gt;</span>

<span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span>  <span class="p">})</span>
<span class="p">}).</span><span class="nx">connect</span><span class="p">(</span><span class="nx">options</span><span class="p">)</span>
</code></pre></div></p>

<p>You can fork <a href="https://github.com/smerrill/node-sweetdudebot">node-sweetdudebot</a> or its predecessor, <a href="https://github.com/smerrill/node-sedbot">node-sedbot</a> on GitHub. Enjoy!</p>
]]></content>
  </entry>
  
</feed>
